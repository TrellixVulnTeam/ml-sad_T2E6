<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sad.model package &mdash; SAD 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> SAD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">SAD: Sliced Anti-symmetric Decomposition for Collaborative Filtering</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SAD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>sad.model package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/sad.model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sad-model-package">
<h1>sad.model package<a class="headerlink" href="#sad-model-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-sad.model.base">
<span id="sad-model-base-module"></span><h2>sad.model.base module<a class="headerlink" href="#module-sad.model.base" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.base.ModelBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ModelBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>The abstract model base class. It is the class that all concrete model classes
will inherit from.</p>
<dl class="py property">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sad.model.base.ModelBase.config" title="Permalink to this definition"></a></dt>
<dd><p>Configuration information that is used to initialize the instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.load">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.load" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.load_best">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.load_best" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.load_checkpoint">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.metrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sad.model.base.ModelBase.metrics" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary stores metrics of the model. Subject to change during model
training by callbacks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.parameters_for_monitor">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.reset_parameters">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.reset_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.s3_key_path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">s3_key_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sad.model.base.ModelBase.s3_key_path" title="Permalink to this definition"></a></dt>
<dd><p>A S3 key uniquely assigned to a model instance. Will be setup during model’s
instantiation, and populated to <code class="docutils literal notranslate"><span class="pre">self.spec</span></code>. It is the S3 key of the model’s
remote store if the model will be pushed to a S3 bucket.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.save">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.save" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.save_checkpoint">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/base.html#ModelBase.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelBase.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#sad.model.base.ModelBase.spec" title="Permalink to this definition"></a></dt>
<dd><p>A reference to <code class="docutils literal notranslate"><span class="pre">&quot;spec&quot;</span></code> field in <code class="docutils literal notranslate"><span class="pre">self.config</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.task">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">task</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">sad.task.training.TrainingTask</span></em><a class="headerlink" href="#sad.model.base.ModelBase.task" title="Permalink to this definition"></a></dt>
<dd><p>An instance of training task associated with current model. It is the task
instance in which a model is initialized.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.base.ModelBase.working_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">working_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sad.model.base.ModelBase.working_dir" title="Permalink to this definition"></a></dt>
<dd><p>Alias to <code class="docutils literal notranslate"><span class="pre">self.task.output_dir</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sad.model.base.ModelFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ModelFactory</span></span><a class="reference internal" href="../_modules/sad/model/base.html#ModelFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelFactory" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A factory class that is responsible to create model instances.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sad.model.base.ModelFactory.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">model.ModelFactory</span> <span class="pre">(INFO)&gt;</span></em><a class="headerlink" href="#sad.model.base.ModelFactory.logger" title="Permalink to this definition"></a></dt>
<dd><p>Class attribute for logging.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelFactory.produce">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">produce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><span class="pre">sad.model.base.ModelBase</span></a></span></span><a class="reference internal" href="../_modules/sad/model/base.html#ModelFactory.produce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelFactory.produce" title="Permalink to this definition"></a></dt>
<dd><p>A class method to create instances of <code class="docutils literal notranslate"><span class="pre">sad.model.ModelBase</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">config</span></code>) – <p>Configuration used to initialize instance object. An
example is given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">SADModel</span>
<span class="n">spec</span><span class="p">:</span>
  <span class="n">n</span><span class="p">:</span> <span class="mi">200</span>
  <span class="n">m</span><span class="p">:</span> <span class="mi">500</span>
  <span class="n">k</span><span class="p">:</span> <span class="mi">100</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.base.ModelFactory.register">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><span class="pre">sad.model.base.ModelBase</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><span class="pre">sad.model.base.ModelBase</span></a></span></span><a class="reference internal" href="../_modules/sad/model/base.html#ModelFactory.register"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.base.ModelFactory.register" title="Permalink to this definition"></a></dt>
<dd><p>A class decorator responsible to decorate <code class="docutils literal notranslate"><span class="pre">sad.model.ModelBase</span></code> classes
and register them into <code class="docutils literal notranslate"><span class="pre">ModelFactory.registry</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.bpr">
<span id="sad-model-bpr-module"></span><h2>sad.model.bpr module<a class="headerlink" href="#module-sad.model.bpr" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BPRModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.calculate_preference_tensor">
<span class="sig-name descname"><span class="pre">calculate_preference_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.calculate_preference_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.calculate_preference_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference tensor <code class="docutils literal notranslate"><span class="pre">self.X</span></code> using user and item matrices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.calculate_probability_tensor">
<span class="sig-name descname"><span class="pre">calculate_probability_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.calculate_probability_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.calculate_probability_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Calculate probability tensor by applying logistic function to preference
tensor <code class="docutils literal notranslate"><span class="pre">self.X</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.draw_observation_tensor">
<span class="sig-name descname"><span class="pre">draw_observation_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.draw_observation_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.draw_observation_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Draw a complete observation tensor from the generative model of BPR.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Three-way tensor with dimension <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">m</span> <span class="pre">x</span> <span class="pre">m</span></code> representing
personalized preferences between item pairs.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.get_gradient_wrt_xuij">
<span class="sig-name descname"><span class="pre">get_gradient_wrt_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.get_gradient_wrt_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.get_gradient_wrt_xuij" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Take
<code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">1</span></code> suggests <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item is
more preferable than <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user. <code class="docutils literal notranslate"><span class="pre">-1</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">0</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return <code class="docutils literal notranslate"><span class="pre">d(p)/d(x_uij)</span></code>, the gradient of log likehood with
respect to <code class="docutils literal notranslate"><span class="pre">x_uij</span></code>, the <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code> element in preference
tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.get_t_sparsity">
<span class="sig-name descname"><span class="pre">get_t_sparsity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.get_t_sparsity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.get_t_sparsity" title="Permalink to this definition"></a></dt>
<dd><p>Extract the number of elements that are close to <code class="docutils literal notranslate"><span class="pre">1</span></code> in item right vectors
<code class="docutils literal notranslate"><span class="pre">self.T</span></code> and return proportion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user.
Parameter values in current model will be used to calculate the preference score
if no parameter arguments provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – User index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.n-1</span></code>.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Item index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.m-1</span></code>.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Item index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.m-1</span></code>.</p></li>
<li><p><strong>XI</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional user matrix. When provided, user vector
will be taken from provided <code class="docutils literal notranslate"><span class="pre">XI</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.XI</span></code>.</p></li>
<li><p><strong>H</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional item matrix. When provided, item vector
will be taken from provided <code class="docutils literal notranslate"><span class="pre">H</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.H</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item and <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th
item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.gradient_update">
<span class="sig-name descname"><span class="pre">gradient_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_l2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_l1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.gradient_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.gradient_update" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>g</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – The gradient of log likelihood wrt <code class="docutils literal notranslate"><span class="pre">x_uij</span></code>.</p></li>
<li><p><strong>w_l2</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – The weight of l2 regularization.</p></li>
<li><p><strong>w_l1</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – The weight of l1 regularization.</p></li>
<li><p><strong>lr</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – Learning rate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.initialize_params">
<span class="sig-name descname"><span class="pre">initialize_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.initialize_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.initialize_params" title="Permalink to this definition"></a></dt>
<dd><p>Initialize user matrix <code class="docutils literal notranslate"><span class="pre">self.XI</span></code> and item matrix <code class="docutils literal notranslate"><span class="pre">self.H</span></code> by drawing
entries from a standard normal distribution.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.bpr.BPRModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model parameters are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.load_best" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Load model checkpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model parameters are stored.</p></li>
<li><p><strong>checkpoint_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Model parameters will be loaded from file with
name <code class="docutils literal notranslate"><span class="pre">&quot;model-params-{checkpoint_id:05d}.npz&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Take
<code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item is
more preferable than <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
<li><p><strong>XI</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional user matrix. When provided, user vector
will be taken from provided <code class="docutils literal notranslate"><span class="pre">XI</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.XI</span></code>.</p></li>
<li><p><strong>H</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional item matrix. When provided, item vector
will be taken from provided <code class="docutils literal notranslate"><span class="pre">H</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.H</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation
is missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.bpr.BPRModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.bpr.BPRModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Extract the number of elements that are close to <code class="docutils literal notranslate"><span class="pre">1</span></code> in item right vectors
<code class="docutils literal notranslate"><span class="pre">self.T</span></code> and return proportion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'model-params.npz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save model parameters to a file named <code class="docutils literal notranslate"><span class="pre">&quot;model-params.npz&quot;</span></code> under
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path)</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.bpr.BPRModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/bpr.html#BPRModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.bpr.BPRModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Save model checkpoints to a file under
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path)</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.cornac">
<span id="sad-model-cornac-module"></span><h2>sad.model.cornac module<a class="headerlink" href="#module-sad.model.cornac" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CornacModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.cornac_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cornac_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">cornac.models.recommender.Recommender</span></em><a class="headerlink" href="#sad.model.cornac.CornacModel.cornac_model" title="Permalink to this definition"></a></dt>
<dd><p>A model instance object from Cornac package. This model will be initialized
via <code class="docutils literal notranslate"><span class="pre">sad.trainer.CornacTrainer</span></code> when calling method
<code class="docutils literal notranslate"><span class="pre">self.initialize_cornac_model()</span></code> of this class. This is because some parameters
needed to initialize a Cornac model are actually related to trainer
specifications. Therefore those parameters need to be passed from trainer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user. The
preference strength of an item for a user of this model class is the logit of
model’s prediction probability. The difference between preference strengths of
the two items from the provided user is how the preference score is calculated.
For this class, user and item indices are needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – User index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.n-1</span></code>.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Item index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.m-1</span></code>.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Item index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.m-1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item and <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th
item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.initialize_cornac_model">
<span class="sig-name descname"><span class="pre">initialize_cornac_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.trainer.html#sad.trainer.cornac.CornacTrainer" title="sad.trainer.cornac.CornacTrainer"><span class="pre">CornacTrainer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.initialize_cornac_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.initialize_cornac_model" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a model object implemented in Cornac package. Some training
parameters in a <code class="docutils literal notranslate"><span class="pre">trainer</span></code> object will be needed, therefore a
<code class="docutils literal notranslate"><span class="pre">sad.trainer.CornacTrainer</span></code> object is supplied as an argument. The trainer is
supposed to call this method and supply itself as an argument. After calling,
<code class="docutils literal notranslate"><span class="pre">self.cornac_model</span></code> property will contain the actual model object.
<code class="docutils literal notranslate"><span class="pre">&quot;cornac_model_name&quot;</span></code> field in <code class="docutils literal notranslate"><span class="pre">self.spec</span></code> contains the class name that will
be used to initialize a Cornac model instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trainer</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sad.trainer.CornacTrainer</span></code>) – A trainer that will call this
method to initialize a Cornac model.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AttributeError</strong> – When supplied <code class="docutils literal notranslate"><span class="pre">&quot;cornac_model_name&quot;</span></code> is not an existing
    Cornac model class in <code class="docutils literal notranslate"><span class="pre">models</span></code> module from Cornac package.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.cornac.CornacModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from a folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and some additional information are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.load_best" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Take
<code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item is
more preferable than <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation
is missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.cornac.CornacModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.cornac.CornacModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Return nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Doing nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save trained Cornac model to a folder (<code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>) rooted at
<code class="docutils literal notranslate"><span class="pre">working_dir</span></code>. The actual save operation will be delegated to
<code class="docutils literal notranslate"><span class="pre">self.cornac_model.save()</span></code>. In the meanwhile, some additional fields defined
by <code class="docutils literal notranslate"><span class="pre">ADDITIONAL_FIELD_NAMES</span></code> macro in this module will be serialized to pickle
files in the same folder.</p>
<p>Model configuration (<code class="docutils literal notranslate"><span class="pre">self.config</span></code>) will be saved too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and some additional information will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.cornac.CornacModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/cornac.html#CornacModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.cornac.CornacModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.fm">
<span id="sad-model-fm-module"></span><h2>sad.model.fm module<a class="headerlink" href="#module-sad.model.fm" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.fm.FMModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FMModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.fm_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">rankfm.rankfm.RankFM</span></em><a class="headerlink" href="#sad.model.fm.FMModel.fm_model" title="Permalink to this definition"></a></dt>
<dd><p>The Factorization Machine (FM) model instance object. We are using the
implementation of FM from <code class="docutils literal notranslate"><span class="pre">RankFM</span></code> package. This model will be initialized via
<code class="docutils literal notranslate"><span class="pre">sad.trainer.FMTrainer</span></code> when calling method <code class="docutils literal notranslate"><span class="pre">self.initialize_fm_model()</span></code> of
this class. This is because some paraemters that are required to initialize a
<code class="docutils literal notranslate"><span class="pre">RankFM</span></code> model are owned by trainer. Therefore those parameters need to be
passed from the trainer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user. The
preference strength of an item for a user of this model class is the logit of
model’s prediction probability. The difference between preference strengths of
the two items from the provided user is how the preference score is calculated.
For this class, user and item ids (not indices) are needed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – User ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> and <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for
user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.initialize_fm_model">
<span class="sig-name descname"><span class="pre">initialize_fm_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.trainer.html#sad.trainer.fm.FMTrainer" title="sad.trainer.fm.FMTrainer"><span class="pre">FMTrainer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.initialize_fm_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.initialize_fm_model" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a FM model object implemented in package <code class="docutils literal notranslate"><span class="pre">RankFM</span></code>. Some training
parameters in a <code class="docutils literal notranslate"><span class="pre">trainer</span></code> object will be needed, therefore a
<code class="docutils literal notranslate"><span class="pre">sad.trainer.FMTrainer</span></code> object is supplied as an argument. The trainer
is supposed to call this method and supply itself as an argument. After calling,
<code class="docutils literal notranslate"><span class="pre">self.fm_model</span></code> property will contain the actual model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trainer</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sad.trainer.FMTrainer</span></code>) – A trainer that will call this
method to initialize a FM model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.fm.FMModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from a folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and configuration are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.load_best" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A user ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of left item in preference tensor.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of right item in preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code> from dataset.
Take <code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> is
more preferable than item <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation
is missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.fm.FMModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.fm.FMModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Return nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Doing nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save trained FM model to a folder (<code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>) rooted at
<code class="docutils literal notranslate"><span class="pre">working_dir</span></code>. The trained FM model (<code class="docutils literal notranslate"><span class="pre">self.fm_model</span></code>) will be saved as a
pickle file named <code class="docutils literal notranslate"><span class="pre">model.pickle</span></code> under the folder.</p>
<p>Model configuration (<code class="docutils literal notranslate"><span class="pre">self.config</span></code>) will be saved too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and its configuration will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.fm.FMModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/fm.html#FMModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.fm.FMModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.msft_ncf">
<span id="sad-model-msft-ncf-module"></span><h2>sad.model.msft_ncf module<a class="headerlink" href="#module-sad.model.msft_ncf" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MSFTRecNCFModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user. The
preference strength of an item for a user of this model class is the logit of
model’s prediction probability. The difference between preference strengths of
the two items from the provided user is how the preference score is calculated.
For this class, user and item ids (instead of indices) are needed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – User ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> and <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for
user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.initialize_msft_ncf_model">
<span class="sig-name descname"><span class="pre">initialize_msft_ncf_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.trainer.html#sad.trainer.msft_ncf.MSFTRecNCFTrainer" title="sad.trainer.msft_ncf.MSFTRecNCFTrainer"><span class="pre">MSFTRecNCFTrainer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.initialize_msft_ncf_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.initialize_msft_ncf_model" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a <code class="docutils literal notranslate"><span class="pre">NCF</span></code> model object implemented in Python package
<code class="docutils literal notranslate"><span class="pre">recommenders</span></code> . Some training parameters in a <code class="docutils literal notranslate"><span class="pre">trainer</span></code> object will be
needed, therefore a <code class="docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecNCFTrainer</span></code> object is supplied as an
argument. The trainer is supposed to call this method and supply itself as an
argument. After calling, <code class="docutils literal notranslate"><span class="pre">self.msft_ncf_model</span></code> property will contain the actual
model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trainer</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecNCFTrainer</span></code>) – A trainer that will call this
method to initialize a NCF model object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimentions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.layer_sizes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">layer_sizes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.layer_sizes" title="Permalink to this definition"></a></dt>
<dd><p>The layer sizes of the MLP part of the NCF model. Its value will be read
directly from <code class="docutils literal notranslate"><span class="pre">&quot;layer_sizes&quot;</span></code> field in <code class="docutils literal notranslate"><span class="pre">self.spec</span></code>. Default to <code class="docutils literal notranslate"><span class="pre">[128]</span></code>,
a one layer perceptron with 128 nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from a folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and configuration are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.load_best" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A user ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of left item in preference tensor.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of right item in preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code> from dataset.
Take <code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> is
more preferable than item <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation is
missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.model_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.model_type" title="Permalink to this definition"></a></dt>
<dd><p>The type of NCF model that is supported by <code class="docutils literal notranslate"><span class="pre">&quot;recommenders&quot;</span></code> package.
Currently could take <code class="docutils literal notranslate"><span class="pre">&quot;MLP|GMF|NeuMF&quot;</span></code>. Read directly from <code class="docutils literal notranslate"><span class="pre">&quot;model_type&quot;</span></code>
field in <code class="docutils literal notranslate"><span class="pre">self.spec</span></code>. Default to <code class="docutils literal notranslate"><span class="pre">&quot;NeuMF&quot;</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.msft_ncf_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">msft_ncf_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">recommenders.models.ncf.ncf_singlenode.NCF</span></em><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.msft_ncf_model" title="Permalink to this definition"></a></dt>
<dd><p>The Neural Collaborative Filtering (NCF) model instance object. We are using
the implementation of NCF from <code class="docutils literal notranslate"><span class="pre">recommenders</span></code> package developed and maintained
by Mircrosoft. This model will be initialized via
<code class="docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecNCFTrainer</span></code> when calling
method <code class="docutils literal notranslate"><span class="pre">self.initialize_msft_ncf_model()</span></code> of this class. This is because some
parameters required to initialize a NCF model are actually specified in trainer.
Therefore those paraemters need to be passed from trainer to this model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Return nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Doing nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save trained NCF model to a folder (<code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>) rooted at
<code class="docutils literal notranslate"><span class="pre">working_dir</span></code>. The actual saving operation will be delegated to
<code class="docutils literal notranslate"><span class="pre">self.msft_ncf_model.save()</span></code>. In the meanwhile, some additional information
about the model will be saved to <code class="docutils literal notranslate"><span class="pre">additional_info.json</span></code>. Those additional
information will be used when loading a trained NCF model.</p>
<p>Model configuration (<code class="docutils literal notranslate"><span class="pre">self.config</span></code>) will be saved too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and its configuration will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_ncf.MSFTRecNCFModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_ncf.html#MSFTRecNCFModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_ncf.MSFTRecNCFModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.msft_rbm">
<span id="sad-model-msft-rbm-module"></span><h2>sad.model.msft_rbm module<a class="headerlink" href="#module-sad.model.msft_rbm" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MSFTRecRBMModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.bh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bh</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.bh" title="Permalink to this definition"></a></dt>
<dd><p>The bias for hidden unit. The size is <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">k</span></code>. It’s value will be
initialized to zero. When loading a pre-trained <code class="docutils literal notranslate"><span class="pre">MSFTRecRBMModel</span></code>, its value
will be loaded too.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.bv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bv</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.bv" title="Permalink to this definition"></a></dt>
<dd><p>The bias for visible unit. The size is <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">m</span></code>. It’s value will be
initialized to zero. When loading a pre-trained <code class="docutils literal notranslate"><span class="pre">MSFTRecRBMModel</span></code>, its value
will be loaded too.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user. The
preference strength of an item for a user of this model class is the logit of
model’s prediction probability. The difference between preference strengths of
the two items from the provided user is how the preference score is calculated.
For this class, user and item ids (instead of indices) are needed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – User ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> and <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for
user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.hidden_units">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hidden_units</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.hidden_units" title="Permalink to this definition"></a></dt>
<dd><p>The the number of hidden units in the RBM model. Its value will read
directly from <code class="docutils literal notranslate"><span class="pre">&quot;k&quot;</span></code> field in <code class="docutils literal notranslate"><span class="pre">self.spec</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.initialize_msft_rbm_model">
<span class="sig-name descname"><span class="pre">initialize_msft_rbm_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.trainer.html#sad.trainer.msft_rbm.MSFTRecRBMTrainer" title="sad.trainer.msft_rbm.MSFTRecRBMTrainer"><span class="pre">MSFTRecRBMTrainer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.initialize_msft_rbm_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.initialize_msft_rbm_model" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a <code class="docutils literal notranslate"><span class="pre">RBM</span></code> model object implemented in Python package
<code class="docutils literal notranslate"><span class="pre">recommenders</span></code> . Some training parameters in a <code class="docutils literal notranslate"><span class="pre">trainer</span></code> object will be
needed, therefore a <code class="docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecRBMTrainer</span></code> object is supplied as an
argument. The trainer is supposed to call this method and supply itself as an
argument. After calling, <code class="docutils literal notranslate"><span class="pre">self.msft_rbm_model</span></code> property will contain the actual
model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trainer</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecRBMTrainer</span></code>) – A trainer that will call this
method to initialize a RBM model object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from a folder. Need tests to confirm working properly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and configuration are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.load_best" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A user ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of left item in preference tensor.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of right item in preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code> from dataset.
Take <code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> is
more preferable than item <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation is
missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.msft_rbm_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">msft_rbm_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">recommenders.models.rbm.rbm.RBM</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.msft_rbm_model" title="Permalink to this definition"></a></dt>
<dd><p>The Restricted Boltzmann Machine (RBM) model instance object. We are using
the implementation of RBM from <code class="docutils literal notranslate"><span class="pre">recommenders</span></code> package developed and maintained
by Mircrosoft. This model will be initialized via
<code class="docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecRBMTrainer</span></code> when calling method
<code class="docutils literal notranslate"><span class="pre">self.initialize_msft_rbm_model()</span></code> of this class. This is because some
parameters that are required to initialize a RBM model are actually specified in
its trainer.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Return nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Doing nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save trained RBM model to a folder (<code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>) rooted at
<code class="docutils literal notranslate"><span class="pre">working_dir</span></code>. The three parameters in the RBM are first converted to numpy
arrays, and then saved to file <code class="docutils literal notranslate"><span class="pre">weights.npz</span></code> in the folder of
<code class="docutils literal notranslate"><span class="pre">os.path.join(self.s3_key_path,</span> <span class="pre">working_dir)</span></code>.</p>
<p>Model configuration (<code class="docutils literal notranslate"><span class="pre">self.config</span></code>) will be saved too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and its configuration will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_rbm.html#MSFTRecRBMModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_rbm.MSFTRecRBMModel.w">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">w</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#sad.model.msft_rbm.MSFTRecRBMModel.w" title="Permalink to this definition"></a></dt>
<dd><p>The weight in RBM model. The size is in <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">k</span></code>. It’s value will be
initialized to zero. When loading a pre-trained <code class="docutils literal notranslate"><span class="pre">MSFTRecRBMModel</span></code>, its value
will be loaded too.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.msft_vae">
<span id="sad-model-msft-vae-module"></span><h2>sad.model.msft_vae module<a class="headerlink" href="#module-sad.model.msft_vae" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MSFTRecVAEModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.initialize_msft_vae_model">
<span class="sig-name descname"><span class="pre">initialize_msft_vae_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.trainer.html#sad.trainer.msft_vae.MSFTRecVAETrainer" title="sad.trainer.msft_vae.MSFTRecVAETrainer"><span class="pre">MSFTRecVAETrainer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.initialize_msft_vae_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.initialize_msft_vae_model" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a VAE model object implemented in package <code class="docutils literal notranslate"><span class="pre">recommenders</span></code>. Some
training parameters in a <code class="docutils literal notranslate"><span class="pre">trainer</span></code> object will be needed, therefore a
<code class="docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecVAETrainer</span></code> object is supplied as an argument. The trainer
is supposed to call this method and supply itself as the argument. After calling,
<code class="docutils literal notranslate"><span class="pre">self.msft_vae_model</span></code> property will contain the actual model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trainer</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sad.trainer.MSFTRecVAETrainer</span></code>) – A trainer that will call this
method to initialize a VAE model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from a folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and configuration are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.load_best" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A user ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of left item in preference tensor.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of right item in preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code> from dataset.
Take <code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> is
more preferable than item <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation
is missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.msft_vae_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">msft_vae_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">recommenders.models.vae.standard_vae.StandardVAE</span></em><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.msft_vae_model" title="Permalink to this definition"></a></dt>
<dd><p>Variational Auto Encoder (VAE) model instance object. We are using the
implementation of VAE from <code class="docutils literal notranslate"><span class="pre">recommenders</span></code> package developed and maintained by
MSFT. This model will be initialized via <code class="docutils literal notranslate"><span class="pre">sad.trainer.VAETrainer</span></code> when calling
method <code class="docutils literal notranslate"><span class="pre">self.initialize_msft_vae_model()</span></code> of this class. This is because some
parameters that are required to initialize a VAE model are actually specified in
its trainer.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Return nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Doing nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save trained VAE model to a folder (<code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>) rooted at
<code class="docutils literal notranslate"><span class="pre">working_dir</span></code>. The actual saving operation will be delegated to
<code class="docutils literal notranslate"><span class="pre">self.msft_vae_model.model.save()</span></code>.</p>
<p>Model configuration (<code class="docutils literal notranslate"><span class="pre">self.config</span></code>) will be saved too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and its configuration will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.msft_vae.MSFTRecVAEModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/msft_vae.html#MSFTRecVAEModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.msft_vae.MSFTRecVAEModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.sad">
<span id="sad-model-sad-module"></span><h2>sad.model.sad module<a class="headerlink" href="#module-sad.model.sad" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.sad.SADModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SADModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.T_ceiling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T_ceiling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#sad.model.sad.SADModel.T_ceiling" title="Permalink to this definition"></a></dt>
<dd><p>The largest value of T that is allowed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.calculate_preference_tensor">
<span class="sig-name descname"><span class="pre">calculate_preference_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.calculate_preference_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.calculate_preference_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference tensor <code class="docutils literal notranslate"><span class="pre">self.X</span></code> using user and item matrices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.calculate_probability_tensor">
<span class="sig-name descname"><span class="pre">calculate_probability_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.calculate_probability_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.calculate_probability_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Calculate probability tensor by applying logistic function to preference
tensor <code class="docutils literal notranslate"><span class="pre">self.X</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.draw_observation_tensor">
<span class="sig-name descname"><span class="pre">draw_observation_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.draw_observation_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.draw_observation_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Draw a complete observation tensor from the generative model of SAD.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Three-way tensor with dimension <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">m</span> <span class="pre">x</span> <span class="pre">m</span></code> representing
personalized preferences between item pairs.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.get_gradient_wrt_xuij">
<span class="sig-name descname"><span class="pre">get_gradient_wrt_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.get_gradient_wrt_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.get_gradient_wrt_xuij" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Take
<code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item is
more preferable than <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return <code class="docutils literal notranslate"><span class="pre">d(p)/d(x_uij)</span></code>, the gradient of log likehood with
respect to <code class="docutils literal notranslate"><span class="pre">x_uij</span></code>, the <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code> element in preference
tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.get_t_sparsity">
<span class="sig-name descname"><span class="pre">get_t_sparsity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.get_t_sparsity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.get_t_sparsity" title="Permalink to this definition"></a></dt>
<dd><p>Extract the number of elements that are close to <code class="docutils literal notranslate"><span class="pre">1</span></code> in item right vectors
<code class="docutils literal notranslate"><span class="pre">self.T</span></code> and return proportion. When <code class="docutils literal notranslate"><span class="pre">self.inner_flag</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, it is
exponentiation of <code class="docutils literal notranslate"><span class="pre">self.T</span></code> will be used to calculate this number.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user.
Parameter values in current model will be used to calculate the preference score
if no additional parameters are provided as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – User index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.n-1</span></code>.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Item index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.m-1</span></code>.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Item index, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">self.m-1</span></code>.</p></li>
<li><p><strong>XI</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional user matrix. When provided, user vector
will be taken from provided <code class="docutils literal notranslate"><span class="pre">XI</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.XI</span></code>.</p></li>
<li><p><strong>H</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional left item matrix. When provided, left
item vector will be taken from provided <code class="docutils literal notranslate"><span class="pre">H</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.H</span></code>.</p></li>
<li><p><strong>T</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional right item matrix. When provided, right
item vector will be taken from provided <code class="docutils literal notranslate"><span class="pre">T</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.T</span></code>.
Subject to exponentiation when <code class="docutils literal notranslate"><span class="pre">self.inner_flag</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item and <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th
item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.gradient_update">
<span class="sig-name descname"><span class="pre">gradient_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_l2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_l1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.gradient_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.gradient_update" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>g</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – The gradient of log likelihood wrt <code class="docutils literal notranslate"><span class="pre">x_uij</span></code>.</p></li>
<li><p><strong>w_l2</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – The weight of l2 regularization.</p></li>
<li><p><strong>w_l1</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – The weight of l1 regularization.</p></li>
<li><p><strong>lr</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>) – Learning rate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.initialize_params">
<span class="sig-name descname"><span class="pre">initialize_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.initialize_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.initialize_params" title="Permalink to this definition"></a></dt>
<dd><p>Initialize user matrix <code class="docutils literal notranslate"><span class="pre">self.XI</span></code>, left item matrix <code class="docutils literal notranslate"><span class="pre">self.H</span></code> and right item
matrix <code class="docutils literal notranslate"><span class="pre">self.T</span></code> by drawing entries from a standard normal distribution. When
right item matrix is assumed to be non-negative (<code class="docutils literal notranslate"><span class="pre">self.inner_flag</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>),
<code class="docutils literal notranslate"><span class="pre">self.T</span></code> will be storing the logrithm of true tau matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.inner_flag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inner_flag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sad.model.sad.SADModel.inner_flag" title="Permalink to this definition"></a></dt>
<dd><p>Whether right matrix will be non-negative.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.sad.SADModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model parameters are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.load_best" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Load model checkpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model parameters are stored.</p></li>
<li><p><strong>checkpoint_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Model parameters will be loaded from file with
name <code class="docutils literal notranslate"><span class="pre">&quot;model-params-{checkpoint_id:05d}.npz&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">XI</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of user in user set. 0-based.</p></li>
<li><p><strong>i_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of i-th item. It is the idx of left item in
preference tensor.</p></li>
<li><p><strong>j_idx</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – Index of j-th item. It is the idx of right item in
preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Take
<code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests <code class="docutils literal notranslate"><span class="pre">i_idx</span></code>-th item is
more preferable than <code class="docutils literal notranslate"><span class="pre">j_idx</span></code>-th item for <code class="docutils literal notranslate"><span class="pre">u_idx</span></code>-th user. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
<li><p><strong>XI</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional user matrix. When provided, user vector
will be taken from provided <code class="docutils literal notranslate"><span class="pre">XI</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.XI</span></code>.</p></li>
<li><p><strong>H</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional left item matrix. When provided, left item
vector will be taken from provided <code class="docutils literal notranslate"><span class="pre">H</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.H</span></code>.</p></li>
<li><p><strong>T</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An optional right item matrix. When provided, right
item vector will be taken from provided <code class="docutils literal notranslate"><span class="pre">T</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.T</span></code>.
Subject to exponentiation when <code class="docutils literal notranslate"><span class="pre">self.inner_flag</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation at <code class="docutils literal notranslate"><span class="pre">(u_idx,</span> <span class="pre">i_idx,</span> <span class="pre">j_idx)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation
is missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.sad.SADModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.sad.SADModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Extract the number of elements that are close to <code class="docutils literal notranslate"><span class="pre">1</span></code> in item right vectors
<code class="docutils literal notranslate"><span class="pre">self.T</span></code> and return proportion. When <code class="docutils literal notranslate"><span class="pre">self.inner_flag</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, it is
exponentiation of <code class="docutils literal notranslate"><span class="pre">self.T</span></code> will be used to calculate this number.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'model-params.npz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save model parameters to a file named <code class="docutils literal notranslate"><span class="pre">&quot;model-params.npz&quot;</span></code> under
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path)</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.sad.SADModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/sad.html#SADModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.sad.SADModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Save model checkpoints to a file under
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path)</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model.svd">
<span id="sad-model-svd-module"></span><h2>sad.model.svd module<a class="headerlink" href="#module-sad.model.svd" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SVDModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.task.training.html#sad.task.training.training.TrainingTask" title="sad.task.training.training.TrainingTask"><span class="pre">TrainingTask</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sad.model.base.ModelBase" title="sad.model.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">sad.model.base.ModelBase</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.get_xuij">
<span class="sig-name descname"><span class="pre">get_xuij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.get_xuij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.get_xuij" title="Permalink to this definition"></a></dt>
<dd><p>Calculate preference score between two items for a particular user. The
preference strength of an item for a user of this model class is the logit of
model’s prediction probability. The difference between preference strengths of
the two items from the provided user is how the preference score is calculated.
For this class, user and item ids (instead of indices) are needed as arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – User ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Item ID.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Preference score between item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> and <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for
user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.initialize_svd_model">
<span class="sig-name descname"><span class="pre">initialize_svd_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sad.trainer.html#sad.trainer.svd.SVDTrainer" title="sad.trainer.svd.SVDTrainer"><span class="pre">SVDTrainer</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.initialize_svd_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.initialize_svd_model" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a SVD model object implemented in package <code class="docutils literal notranslate"><span class="pre">surprise</span></code>. Some
training parameters in a <code class="docutils literal notranslate"><span class="pre">trainer</span></code> object will be needed, therefore a
<code class="docutils literal notranslate"><span class="pre">sad.trainer.SVDTrainer</span></code> object is supplied as an argument. The trainer
is supposed to call this method and supply itself as the argument. After calling,
<code class="docutils literal notranslate"><span class="pre">self.svd_model</span></code> property will contain the actual model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trainer</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sad.trainer.SVDTrainer</span></code>) – A trainer that will call this
method to initialize a SVD model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.svd.SVDModel.k" title="Permalink to this definition"></a></dt>
<dd><p>The number of latent dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from a folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and configuration are stored.</p></li>
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Filename containing model parameters. The full path
of the file will be
<code class="docutils literal notranslate"><span class="pre">os.path.join(working_dir,</span> <span class="pre">self.s3_key_path,</span> <span class="pre">filename)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.load_best">
<span class="sig-name descname"><span class="pre">load_best</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ll'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.load_best"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.load_best" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.load_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Havn’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.log_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Calculate log likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A user ID.</p></li>
<li><p><strong>i_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of left item in preference tensor.</p></li>
<li><p><strong>j_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – An item ID. The ID of right item in preference tensor.</p></li>
<li><p><strong>obs_uij</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>) – The observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code> from dataset.
Take <code class="docutils literal notranslate"><span class="pre">1|-1|0</span></code> three different values. <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code> suggests item <code class="docutils literal notranslate"><span class="pre">i_id</span></code> is
more preferable than item <code class="docutils literal notranslate"><span class="pre">j_id</span></code> for user <code class="docutils literal notranslate"><span class="pre">u_id</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>
suggests the opposite. <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code> means the preference information is not
available (missing data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the contribution to the log likelihood from
observation of <code class="docutils literal notranslate"><span class="pre">(u_id,</span> <span class="pre">i_id,</span> <span class="pre">j_id)</span></code>. Return <code class="docutils literal notranslate"><span class="pre">0</span></code> when the observation is
missing.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.svd.SVDModel.m" title="Permalink to this definition"></a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sad.model.svd.SVDModel.n" title="Permalink to this definition"></a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.parameters_for_monitor">
<span class="sig-name descname"><span class="pre">parameters_for_monitor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.parameters_for_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.parameters_for_monitor" title="Permalink to this definition"></a></dt>
<dd><p>Return nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.prediction_cache">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_cache</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sad.model.svd.SVDModel.prediction_cache" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary contains the prediction cache. The key is a user id and item id
pair, and value is model’s prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.reset_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Doing nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'model-params.npz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save trained SVD model to a folder (<code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>) rooted at
<code class="docutils literal notranslate"><span class="pre">working_dir</span></code>. The model object <code class="docutils literal notranslate"><span class="pre">self.svd_model</span></code> will be saved as a pickle
file named <code class="docutils literal notranslate"><span class="pre">model.pickle</span></code> in the folder.</p>
<p>Model configuration (<code class="docutils literal notranslate"><span class="pre">self.config</span></code>) will be saved too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>working_dir</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The containing folder of <code class="docutils literal notranslate"><span class="pre">self.s3_key_path</span></code>
where model and its configuration will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sad/model/svd.html#SVDModel.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sad.model.svd.SVDModel.save_checkpoint" title="Permalink to this definition"></a></dt>
<dd><p>Haven’t implemented this functionality yet.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sad.model.svd.SVDModel.svd_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">svd_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">surprise.prediction_algorithms.matrix_factorization.SVD</span></em><a class="headerlink" href="#sad.model.svd.SVDModel.svd_model" title="Permalink to this definition"></a></dt>
<dd><p>Singular Value Decomposition (SVD) model instance object. We are using the
implementation of SVD from <code class="docutils literal notranslate"><span class="pre">surprise</span></code> package. This model will be initialized
via <code class="docutils literal notranslate"><span class="pre">sad.trainer.SVDTrainer</span></code> when calling method
<code class="docutils literal notranslate"><span class="pre">self.initialize_svd_model()</span></code> of this class.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sad.model">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-sad.model" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, AIML/Apple.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>